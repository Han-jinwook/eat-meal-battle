"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[145],{1525:(e,t,o)=>{o.d(t,{$k:()=>l,UU:()=>s});var n=o(4175);let a=null,r=()=>!0,s=()=>{if(a)return a;if(!r())return console.debug("서버 환경에서 Supabase 클라이언트 호출 - 제한된 기능"),{auth:{getSession:()=>({data:{session:null}}),getUser:()=>({data:{user:null}}),signOut:()=>Promise.resolve({error:null}),signInWithOAuth:()=>Promise.resolve({data:null,error:Error("서버 환경에서는 OAuth 불가")})},from:()=>({select:()=>({eq:()=>({single:()=>Promise.resolve({data:null,error:null}),data:[],error:null})})})};let e="https://izkumvvlkrkgiuuczffp.supabase.co",t="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Iml6a3VtdnZsa3JrZ2l1dWN6ZmZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDU0MTI3NzksImV4cCI6MjA2MDk4ODc3OX0.pQH_znuBuBfLBJdnMagX4_HE37Z8uraCp1_MaJFtEfc";try{return a=(0,n.kT)(e,t,{auth:{autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"pkce"},cookies:{get(e){if("undefined"!=typeof document){var t;let o="; ".concat(document.cookie).split("; ".concat(e,"="));if(2===o.length)return null==(t=o.pop())?void 0:t.split(";").shift()}},set(e,t,o){if("undefined"!=typeof document){let n="".concat(e,"=").concat(t);(null==o?void 0:o.maxAge)&&(n+="; max-age=".concat(o.maxAge)),(null==o?void 0:o.path)&&(n+="; path=".concat(o.path)),(null==o?void 0:o.domain)&&(n+="; domain=".concat(o.domain)),(null==o?void 0:o.secure)&&(n+="; secure"),(null==o?void 0:o.httpOnly)&&(n+="; httponly"),(null==o?void 0:o.sameSite)&&(n+="; samesite=".concat(o.sameSite)),document.cookie=n}},remove(e,t){if("undefined"!=typeof document){let o="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 GMT");(null==t?void 0:t.path)&&(o+="; path=".concat(t.path)),(null==t?void 0:t.domain)&&(o+="; domain=".concat(t.domain)),document.cookie=o}}},global:{fetch:function(){for(var e,o,n,a=arguments.length,r=Array(a),s=0;s<a;s++)r[s]=arguments[s];let c=String(r[0]instanceof URL?r[0].toString():r[0]),l=["/meal_images","/profiles","/menu_item_ratings","/school_infos","/quiz","/comment_likes"].some(e=>c.includes(e)||c.includes("school_infos")||c.includes("/quiz"));if(c.includes("/rest/v1/")){let e=(null==(n=r[1])?void 0:n.headers)||{};r[1]={...r[1],headers:{...e,apikey:t,Authorization:"Bearer ".concat(t),Accept:"application/json"}}}return!c.includes("/rest/v1/")||l||(null==(e=r[1])?void 0:e.headers)&&Object.entries((null==(o=r[1])?void 0:o.headers)||{}).some(e=>{let[t,o]=e;return"apikey"===t.toLowerCase()||"authorization"===t.toLowerCase()})?c.includes("/comment_likes")?(r[1]||(r[1]={}),r[1].headers||(r[1].headers={}),r[1].headers.Accept="application/json",r[1].headers["Content-Type"]="application/json",fetch(...r).then(e=>200!==e.status?(console.debug("comment_likes 요청 응답 코드 ".concat(e.status," 수정 처리")),new Response(JSON.stringify({data:[]}),{status:200,headers:{"Content-Type":"application/json"}})):e).catch(e=>(console.debug("좋아요 요청 처리 오류 포착:",e),new Response(JSON.stringify({data:[]}),{status:200})))):fetch(...r).catch(e=>{if(404===e.status)return new Response(JSON.stringify({error:"Not found",quiet:!0}),{status:404});throw e}):(console.debug("권한 없는 Supabase REST API 요청 차단:",c),Promise.resolve(new Response(JSON.stringify({message:"No API key found in request",hint:"No 'apikey' request header or url param was found."}),{status:401})))}}})}catch(o){return console.debug("Supabase 클라이언트 초기화 중 오류 발생 (무시됨)"),a=(0,n.kT)(e,t)}},c=async()=>{try{let e=s();await e.auth.signOut();{let e=[];for(let t=0;t<localStorage.length;t++){let o=localStorage.key(t);o&&(o.startsWith("sb-")||o.includes("supabase"))&&e.push(o)}e.forEach(e=>localStorage.removeItem(e)),sessionStorage.clear(),document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+new Date().toUTCString()+";path=/")})}a=null,console.debug("세션 완전 정리 완료")}catch(e){console.debug("세션 정리 중 오류 (무시됨):",e)}},l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,o=s();console.log("\uD83D\uDD0D 로그인 시도 환경 정보:",{url:"https://izkumvvlkrkgiuuczffp.supabase.co",provider:e,userAgent:navigator.userAgent,cookiesEnabled:navigator.cookieEnabled,localStorage:"undefined"!=typeof localStorage,currentUrl:window.location.href});for(let n=1;n<=t;n++)try{console.log("\uD83D\uDE80 로그인 시도 ".concat(n,"/").concat(t," 시작")),n>1&&(console.log("\uD83E\uDDF9 이전 세션 정리 중..."),await c(),await new Promise(e=>setTimeout(e,1e3)));let{data:a}=await o.auth.getSession();console.log("\uD83D\uDCCA 현재 세션 상태:",a.session?"있음":"없음");let{data:r,error:s}=await o.auth.signInWithOAuth({provider:e,options:{redirectTo:"".concat(window.location.origin,"/auth/callback"),queryParams:{access_type:"offline",prompt:"consent"}}});if(console.log("✅ OAuth 요청 결과:",{data:r,error:s}),s)throw s;return{data:r,error:null}}catch(o){if(console.error("❌ 로그인 시도 ".concat(n,"/").concat(t," 실패:"),{error:o,errorMessage:null==o?void 0:o.message,errorCode:null==o?void 0:o.status,timestamp:new Date().toISOString()}),n===t)return{data:null,error:o};let e=1e3*Math.pow(2,n);console.log("⏳ ".concat(e,"ms 대기 후 재시도...")),await new Promise(t=>setTimeout(t,e))}}},1653:(e,t,o)=>{o.d(t,{A:()=>a});var n=o(4568);function a(e){let{selectedDate:t,onDateChange:o,className:a="",theme:r="blue",size:s="md",showWeekday:c=!0}=e,l=e=>{if(t)try{let n=new Date(t);if(isNaN(n.getTime()))return;let a=new Date(n);"prev"===e?a.setDate(n.getDate()-1):a.setDate(n.getDate()+1);let r=a.getFullYear(),s=String(a.getMonth()+1).padStart(2,"0"),c=String(a.getDate()).padStart(2,"0"),l="".concat(r,"-").concat(s,"-").concat(c);o(l)}catch(e){console.error("날짜 네비게이션 오류:",e)}},i={blue:{bg:"bg-blue-50 hover:bg-blue-100",border:"border-blue-100",text:"text-blue-600",badge:"bg-blue-100 text-blue-700"},red:{bg:"bg-red-50 hover:bg-red-100",border:"border-red-100",text:"text-red-600",badge:"bg-red-100 text-red-700"},green:{bg:"bg-green-50 hover:bg-green-100",border:"border-green-100",text:"text-green-600",badge:"bg-green-100 text-green-700"},purple:{bg:"bg-purple-50 hover:bg-purple-100",border:"border-purple-100",text:"text-purple-600",badge:"bg-purple-100 text-purple-700"},orange:{bg:"bg-orange-50 hover:bg-orange-100",border:"border-orange-100",text:"text-orange-600",badge:"bg-orange-100 text-orange-700"}}[r],u={sm:{button:"w-6 h-6",icon:"h-3 w-3",padding:"px-1.5 py-1",text:"text-xs",badge:"text-xs px-1 py-0.5"},md:{button:"w-8 h-8",icon:"h-4 w-4",padding:"px-2 py-1.5",text:"text-sm",badge:"text-xs px-1.5 py-0.5"},lg:{button:"w-10 h-10",icon:"h-5 w-5",padding:"px-3 py-2",text:"text-base",badge:"text-sm px-2 py-1"}}[s];return(0,n.jsxs)("div",{className:"mb-2 mt-1 ".concat(a),children:[(0,n.jsx)("input",{type:"date",id:"date-navigator-input",value:t,onChange:e=>{o(e.target.value)},className:"sr-only"}),(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("button",{onClick:()=>l("prev"),className:"flex items-center justify-center ".concat(u.button," ").concat(i.bg," rounded border ").concat(i.border," shadow-sm transition-colors"),title:"이전 날짜",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"".concat(u.icon," ").concat(i.text),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),(0,n.jsx)("button",{onClick:()=>{var e;let t=document.getElementById("date-navigator-input");null==t||null==(e=t.showPicker)||e.call(t)},className:"flex-1 flex items-center justify-between ".concat(u.padding," ").concat(i.bg," rounded border ").concat(i.border," shadow-sm transition-colors"),children:t&&(()=>{let e=new Date(t);if(!isNaN(e.getTime())){let t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0"),r=["일","월","화","수","목","금","토"][e.getDay()];return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("span",{className:"".concat(i.text," mr-1"),children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:u.icon,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 002 2z"})})}),(0,n.jsx)("span",{className:"".concat(u.text," font-medium text-gray-700"),children:"".concat(t,"-").concat(o,"-").concat(a)}),c&&(0,n.jsx)("span",{className:"ml-1 font-medium ".concat(u.badge," ").concat(i.badge," rounded"),children:r})]}),(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"".concat(u.icon," ").concat(i.text),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]})}return t})()}),(0,n.jsx)("button",{onClick:()=>l("next"),className:"flex items-center justify-center ".concat(u.button," ").concat(i.bg," rounded border ").concat(i.border," shadow-sm transition-colors"),title:"다음 날짜",children:(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"".concat(u.icon," ").concat(i.text),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]})]})}o(7620)},6202:(e,t,o)=>{o.d(t,{A:()=>r});var n=o(7620),a=o(1525);function r(){let e=(0,a.UU)(),[t,o]=(0,n.useState)(null),[r,s]=(0,n.useState)(null),[c,l]=(0,n.useState)(!1),[i,u]=(0,n.useState)(""),[d,g]=(0,n.useState)(0),p=(0,n.useCallback)(()=>{g(e=>e+1)},[]);return(0,n.useEffect)(()=>{(async()=>{try{l(!0),u("");let{data:{user:t},error:n}=await e.auth.getUser();if(n)throw n;if(o(t),t){let{data:o,error:n}=await e.from("school_infos").select("*").eq("user_id",t.id).single();if(n&&"PGRST116"!==n.code)throw Error("학교 정보 조회 에러: ".concat(n.message));o?s({...o,class:o.class_number}):s(null)}else s(null)}catch(e){console.error("useUserSchool 오류:",e),u(e.message||"사용자 정보를 불러오는 중 오류")}finally{l(!1)}})()},[e,d]),{user:t,userSchool:r,loading:c,error:i,refresh:p}}},8670:(e,t,o)=>{o.d(t,{AV:()=>r,EK:()=>a,g1:()=>n});let n=e=>{if(!e)return e;let t=e;8!==e.length||e.includes("-")||(t="".concat(e.slice(0,4),"-").concat(e.slice(4,6),"-").concat(e.slice(6,8)));let o=new Date(t);if(isNaN(o.getTime()))return t;let n=["일","월","화","수","목","금","토"][o.getDay()];return"".concat(t," (").concat(n,")")},a=e=>e?8!==e.length||e.includes("-")?e.replace(/-/g,""):(console.log("이미 API 형식인 날짜: ".concat(e)),e):"",r=()=>{let e=new Date,t=e.getFullYear(),o=String(e.getMonth()+1).padStart(2,"0"),n=String(e.getDate()).padStart(2,"0");return"".concat(t,"-").concat(o,"-").concat(n)}}}]);