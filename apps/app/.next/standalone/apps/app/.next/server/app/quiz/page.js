(()=>{var e={};e.id=602,e.ids=[602],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},8430:(e,t,r)=>{Promise.resolve().then(r.bind(r,93342))},9699:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(41253);let a=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},11997:e=>{"use strict";e.exports=require("punycode")},16654:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var s=r(24332),a=r(48819),n=r(67851),i=r.n(n),o=r(97540),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let c={children:["",{children:["quiz",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,77656)),"D:\\Windsurf\\eat-meal-battle\\apps\\app\\src\\app\\quiz\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,20685)),"D:\\Windsurf\\eat-meal-battle\\apps\\app\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,19033,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,39956,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,92341,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,9699))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["D:\\Windsurf\\eat-meal-battle\\apps\\app\\src\\app\\quiz\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/quiz/page",pathname:"/quiz",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},38694:(e,t,r)=>{Promise.resolve().then(r.bind(r,77656))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},77656:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(33952).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Windsurf\\\\eat-meal-battle\\\\apps\\\\app\\\\src\\\\app\\\\quiz\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Windsurf\\eat-meal-battle\\apps\\app\\src\\app\\quiz\\page.tsx","default")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},91645:e=>{"use strict";e.exports=require("net")},93342:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var s=r(13486),a=r(60159),n=r(2984),i=r(49989),o=r.n(i),l=r(605);function c(){let e=`
    @keyframes confetti-fall {
      0% { transform: translateY(-100vh) rotate(0deg); }
      100% { transform: translateY(100vh) rotate(720deg); }
    }
    
    .confetti-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 50;
      overflow: hidden;
    }
    
    .confetti {
      position: absolute;
      width: 10px;
      height: 10px;
      top: -10px;
      opacity: 0.8;
      animation: confetti-fall 3s linear forwards;
    }
    
    .option-button {
      transition: all 0.3s ease;
    }
    
    .option-button:hover:not(:disabled) {
      transform: scale(1.02);
    }
    
    .option-button:active:not(:disabled) {
      transform: scale(0.98);
    }
    
    .option-dimmed {
      opacity: 0.6;
    }
  `,t=(0,l.U)(),r=(0,n.useRouter)(),[i,c]=(0,a.useState)(!0),[d,u]=(0,a.useState)(null),[p,m]=(0,a.useState)(null),[x,h]=(0,a.useState)(null),[f,b]=(0,a.useState)(!1),[g,v]=(0,a.useState)(null),[j,w]=(0,a.useState)(null),[y,N]=(0,a.useState)([]),[_,q]=(0,a.useState)(null),[z,S]=(0,a.useState)(!1),[k,P]=(0,a.useState)(!1),[C,A]=(0,a.useState)(""),$=async()=>{try{c(!0),A("");let{data:{session:e}}=await t.auth.getSession();if(!e)return void r.push("/login");let s=await fetch("/api/quiz",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok){404===s.status?A("오늘의 퀴즈가 아직 준비되지 않았습니다."):A("퀴즈를 불러오는 중 오류가 발생했습니다."),c(!1);return}let a=await s.json();if(a.error){A(a.error),c(!1);return}a.quiz&&(u(a.quiz),b(a.alreadyAnswered||!1),P(!1),a.alreadyAnswered&&void 0!==a.isCorrect?h({isCorrect:a.isCorrect,correctAnswer:void 0!==a.quiz.correct_answer?a.quiz.correct_answer:0,message:a.isCorrect?"정답입니다!":"틀렸습니다."}):v(Date.now())),c(!1)}catch(e){console.error("퀴즈 로딩 중 오류:",e),A("퀴즈를 불러오는 중 오류가 발생했습니다."),c(!1)}},D=async e=>{if(!k&&!f&&d&&null===p)try{P(!0),m(e);let s=Date.now(),a=g?Math.round((s-g)/1e3):10;w(a);let{data:{session:n}}=await t.auth.getSession();if(!n)return void r.push("/login");let i=await fetch("/api/quiz/answer",{method:"POST",headers:{Authorization:`Bearer ${n.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({quiz_id:d.id,selected_option:e,answer_time:a})}),o=await i.json();if(o.error){A(o.error),P(!1);return}h(o),b(!0),o.isCorrect&&(S(!0),setTimeout(()=>S(!1),3e3)),M()}catch(e){console.error("답변 제출 중 오류:",e),A("답변을 제출하는 중 오류가 발생했습니다.")}finally{P(!1)}},M=async()=>{try{let{data:{session:e}}=await t.auth.getSession();if(!e)return void r.push("/login");let s=await fetch("/api/quiz/champions",{headers:{Authorization:`Bearer ${e.access_token}`}});if(!s.ok)return void console.error("장원 목록 가져오기 실패:",s.status);let a=await s.json();if(a.error)return void console.error("장원 목록 에러:",a.error);if(a.champions){N(a.champions);let{data:{user:e}}=await t.auth.getUser();if(e){let t=a.champions.findIndex(t=>t.user_id===e.id);q(-1!==t?t+1:null)}}}catch(e){console.error("장원 목록 가져오기 중 오류:",e)}};return i?(0,s.jsxs)("main",{className:"flex min-h-[60vh] flex-col items-center justify-center p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),(0,s.jsx)("p",{className:"mt-4 text-gray-600",children:"퀴즈를 불러오는 중입니다..."})]}):C?(0,s.jsxs)("main",{className:"flex min-h-[60vh] flex-col items-center justify-center p-8 text-center",children:[(0,s.jsxs)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded max-w-md",children:[(0,s.jsx)("p",{className:"font-bold",children:"오류 발생"}),(0,s.jsx)("p",{children:C})]}),(0,s.jsx)("button",{onClick:$,className:"mt-4 bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"새로고침"})]}):d?(0,s.jsxs)("main",{className:"flex min-h-[80vh] flex-col items-center p-4 md:p-8 max-w-4xl mx-auto",children:[(0,s.jsx)("style",{dangerouslySetInnerHTML:{__html:e}}),z&&(0,s.jsx)("div",{className:"confetti-container",children:[...Array(50)].map((e,t)=>(0,s.jsx)("div",{className:"confetti",style:{left:`${100*Math.random()}%`,animationDelay:`${3*Math.random()}s`,backgroundColor:`hsl(${360*Math.random()}, 80%, 60%)`}},t))}),(0,s.jsxs)("div",{className:"w-full max-w-2xl",children:[(0,s.jsxs)("div",{className:"mb-6 text-center",children:[(0,s.jsx)("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"오늘의 급식 퀴즈"}),(0,s.jsx)("p",{className:"text-gray-600",children:new Date(d.meal_date).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})}),d.explanation&&f&&(0,s.jsxs)("div",{className:"mt-4 px-3 py-1 rounded-lg text-sm border border-blue-400 bg-blue-50 text-blue-700",children:["해설: ",d.explanation]})]}),(0,s.jsxs)("div",{className:"mb-6 p-4 bg-amber-50 rounded-lg shadow-sm",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"오늘의 메뉴"}),(0,s.jsx)("ul",{className:"list-disc list-inside",children:d.menu_items.map((e,t)=>(0,s.jsx)("li",{className:"text-gray-700",children:e},t))})]}),(0,s.jsxs)("div",{className:"mb-6 p-6 bg-white rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:d.question}),(0,s.jsx)("div",{className:"space-y-3",children:d.options.map((e,t)=>(0,s.jsx)("button",{onClick:()=>D(t),disabled:f||k,className:`w-full p-4 text-left rounded-lg transition-all transform hover:scale-102 border option-button
                  ${p===t?x?.isCorrect?"bg-green-100 border-green-500":"bg-red-100 border-red-500":void 0!==d.correct_answer&&d.correct_answer===t?"bg-green-100 border-green-500":"bg-gray-50 border-gray-200 hover:bg-gray-100"}
                  ${f&&p!==t&&t!==(void 0!==d.correct_answer?d.correct_answer:x?.correctAnswer)?"option-dimmed":""}`,children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("span",{className:"w-8 h-8 flex items-center justify-center rounded-full bg-blue-500 text-white mr-3",children:t+1}),(0,s.jsx)("span",{children:e})]})},t))}),(x||f&&void 0!==d.correct_answer)&&(0,s.jsxs)("div",{className:`mt-6 p-4 rounded-lg ${x?.isCorrect||p===d.correct_answer?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:[(0,s.jsx)("p",{className:"font-bold text-lg",children:x?.message||(p===d.correct_answer?"정답입니다!":"틀렸습니다.")}),null!==j&&(0,s.jsxs)("p",{className:"text-sm mt-1",children:["응답 시간: ",j,"초"]}),void 0!==d.correct_answer&&p!==d.correct_answer&&(0,s.jsxs)("p",{className:"mt-2",children:["정답: ",d.options[d.correct_answer]]})]})]}),(0,s.jsxs)("div",{className:"mt-8 p-6 bg-white rounded-lg shadow-md",children:[(0,s.jsx)("h2",{className:"text-xl font-bold mb-4",children:"이달의 퀴즈 장원"}),0===y.length?(0,s.jsx)("p",{className:"text-gray-600 text-center py-4",children:"아직 장원 기록이 없습니다."}):(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-100",children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"순위"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"이름"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right",children:"정답률"}),(0,s.jsx)("th",{className:"px-4 py-2 text-right",children:"평균 응답시간"})]})}),(0,s.jsx)("tbody",{children:y.map((e,t)=>(0,s.jsxs)("tr",{className:`border-t ${_===t+1?"bg-blue-50":""}`,children:[(0,s.jsx)("td",{className:"px-4 py-3",children:0===t?"\uD83E\uDD47":1===t?"\uD83E\uDD48":2===t?"\uD83E\uDD49":`${t+1}위`}),(0,s.jsxs)("td",{className:"px-4 py-3 flex items-center",children:[e.users.avatar_url&&(0,s.jsx)("img",{src:e.users.avatar_url,alt:"프로필",className:"w-6 h-6 rounded-full mr-2"}),e.users.nickname||"사용자"]}),(0,s.jsxs)("td",{className:"px-4 py-3 text-right",children:[e.correct_count,"/",e.total_count," (",Math.round(e.correct_count/e.total_count*100),"%)"]}),(0,s.jsxs)("td",{className:"px-4 py-3 text-right",children:[e.avg_answer_time.toFixed(1),"초"]})]},e.id))})]})}),null===_&&f&&(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-4 text-center",children:"더 많은 퀴즈에 참여하여 장원 목록에 이름을 올려보세요!"})]})]})]}):(0,s.jsxs)("main",{className:"flex min-h-[60vh] flex-col items-center justify-center p-8 text-center",children:[(0,s.jsxs)("div",{className:"bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded max-w-md",children:[(0,s.jsx)("p",{className:"font-bold",children:"퀴즈가 없습니다"}),(0,s.jsx)("p",{children:"오늘의 퀴즈가 아직 준비되지 않았습니다. 나중에 다시 시도해주세요."})]}),(0,s.jsx)(o(),{href:"/",className:"mt-4 text-blue-500 hover:text-blue-700 font-bold",children:"홈으로 돌아가기"})]})}},94735:e=>{"use strict";e.exports=require("events")}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[50,901,253,195],()=>r(16654));module.exports=s})();