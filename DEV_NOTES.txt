출시전 조건 (퀴즈 -> 당일 퀴즈풀이만 가능하게
루트에 있는 파일들 점검 후 제거 
netli / functions   - cron-meals.js
netli / functions   - manual-generate-meal-quiz.js

===## 주장원/월장원 시스템 구현 🔄 REDESIGNING (2025년 7월 5일 재설계)

### 📋 **정확한 장원 조건 정의**

#### 🏆 **주장원 조건** (ISO 기준)
- **주차 기준**: "각 주차는 '해당 주의 월요일이 속한 달'을 기준으로 묶어 ○월 n주 장원으로 명명"
- **급식일수 조건**: 해당 주 학교별 실제 급식 제공일수와 유저 정답수가 **완전 일치**
- **결정 시점**: 매주 금요일 (급식 실제 발생 확인 + 마지막 퀴즈 완료 후)
- **예시**: 7월 2주차에 급식 3일 제공 → 3일 모두 정답 → 주장원

#### 👑 **월장원 조건**
- **급식일수 조건**: 해당월 학교별 실제 급식 제공 총일수와 유저 정답수가 **완전 일치**
- **결정 시점**: 매월 마지막날 최종 집계
- **예시**: 7월 총 급식 15일 제공 → 15일 모두 정답 → 월장원

### 🗃️ **새로운 DB 스키마** (기존 테이블과 완전 독립)
```sql
CREATE TABLE quiz_champion_statistics (
  id BIGSERIAL PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  school_id BIGINT REFERENCES schools(id),
  
  -- 기간 정보 (ISO 기준)
  year INTEGER NOT NULL,
  month INTEGER NOT NULL, 
  week_number INTEGER, -- 주장원용 (1-6주)
  period_type TEXT NOT NULL CHECK (period_type IN ('weekly', 'monthly')),
  
  -- 급식/퀴즈 통계
  total_meal_days INTEGER NOT NULL,    -- 해당 기간 실제 급식 제공일수
  total_quiz_days INTEGER NOT NULL,    -- 해당 기간 퀴즈 출제일수
  correct_answers INTEGER NOT NULL,    -- 유저 정답수
  
  -- 장원 결과
  is_champion BOOLEAN DEFAULT FALSE,   -- 장원 여부
  determined_at TIMESTAMP,             -- 결정 시점
  
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, school_id, year, month, week_number, period_type)
);
===

### 탈퇴 문제 해결 (2025년 7월 3일)

#### 문제 상황
- UI/UX상 탈퇴처리가 된 듯하나 DB와 Authentication에 사용자 데이터 남아있음

#### 기존 로직 문제점
1. DB에서 users 테이블만 삭제
2. 관련 데이터 (quiz_results, quiz_champions) 미삭제
3. Supabase Auth에서 사용자 계정 미삭제
4. 세션 로그아웃만 수행

#### 해결 방안 구현
1. **관련 데이터 삭제**: quiz_results, quiz_champions 순서대로 삭제
2. **users 테이블 삭제**: 기존 로직 유지
3. **Auth 사용자 삭제**: admin.deleteUser() 사용
4. **세션 로그아웃**: 기존 로직 유지

#### 구현 완료 사항
- ✅ supabase-server.ts에 createAdminClient() 추가
- ✅ delete-account API에 완전한 삭제 로직 구현
- ✅ 외래키 관계 순서대로 데이터 삭제

#### 필요한 설정
⚠️ **중요**: .env 파일에 SUPABASE_SERVICE_ROLE_KEY 추가 필요
```
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
```

#### 테스트 시나리오
1. 탈퇴 버튼 클릭
2. 확인 대화상자 승인
3. 로딩 상태 확인
4. 로그아웃 되어 메인페이지로 이동
5. 로그인 시도시 사용자 없음 오류 확인
6. Supabase Dashboard에서 Authentication 및 Database 완전 삭제 확인